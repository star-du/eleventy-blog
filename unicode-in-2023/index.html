<!DOCTYPE html><html lang="en" dir="auto" class="no-js"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1"><title>在 2023 重新学习 Unicode (UTF-8) - Star`s Note</title><meta property="og:title" content="在 2023 重新学习 Unicode (UTF-8) - Star`s Note"><link rel="stylesheet" href="/eleventy-blog/css/style.css?v=1706284705"><script src="/eleventy-blog/js/scripts.js?v=1706284705"></script><script>"serviceWorker"in navigator&&navigator.serviceWorker.getRegistrations().then((function(e){for(let r of e)r.unregister()}))</script><meta name="description" content="{{ content|truncate(160) }}"><link rel="canonical" href="https://star-du.github.io/eleventy-blog/2023-unicode-utf-8"><meta name="generator" content="Eleventy v2.0.1"><link rel="icon" href="/eleventy-blog/favicon.ico" sizes="any"><link rel="icon" href="/eleventy-blog/favicon.svg" type="image/svg+xml"><link rel="apple-touch-icon" href="/eleventy-blog/apple-touch-icon.png"><link rel="alternate" type="application/rss+xml" title="Star`s Note RSS feed (excerpts)" href="/eleventy-blog/excerpts.xml"><link rel="alternate" type="application/rss+xml" title="Star`s Note RSS feed (full articles)" href="/eleventy-blog/full.xml"><link rel="alternate" type="application/json" title="Star`s Note JSON feed (excerpts)" href="/eleventy-blog/excerpts.json"><link rel="alternate" type="application/json" title="Star`s Note JSON feed (full articles)" href="/eleventy-blog/full.json"><meta property="og:url" content="https://star-du.github.io/eleventy-blog/unicode-in-2023/"><meta property="og:type" content="article"><meta property="og:image" content="https://star-du.github.io/eleventy-blog/images/share-1200x600.jpg"><meta property="twitter:image" content="https://star-du.github.io/eleventy-blog/images/share-1200x600.jpg"><meta property="twitter:card" content="summary_large_image"><script type="application/ld+json">{"@context":"https://schema.org","@type":"Article","headline":"在 2023 重新学习 Unicode (UTF-8)","image":["https://star-du.github.io/eleventy-blog/images/share-1200x600.jpg"],"author":{"@type":"Person","name":"star-du"},"mainEntityOfPage":"https://star-du.github.io/eleventy-blog/unicode-in-2023/","datePublished":"2024-01-26T00:00:00.000Z","description":"{{ content|truncate(160) }}"}</script></head><body><a href="#main" id="skipToMain" class="skip-link">Skip to main content</a><header class="header"><input class="menu-btn" type="checkbox" id="menu-btn"> <label class="hamburger" tabindex="0" for="menu-btn"><span></span></label><div class="main-nav"><div class="site-logo"><a href="/eleventy-blog/" title="Star`s Note - Main page"><span class="site_title">Star`s Note</span></a></div><ul class="site-links"><li><a href="/eleventy-blog/about/">About</a></li><li><a href="/eleventy-blog/all-articles/">All Articles</a></li><li><a href="/eleventy-blog/subscribe/">Subscribe</a></li><li><a href="/eleventy-blog/inspirations/">Inspirations</a></li></ul></div><div class="theme-switcher" tabindex="0"><svg class="dark-toggle" viewBox="0 0 455 455" xmlns="http://www.w3.org/2000/svg"><title>Dark mode switch icon</title><polygon points="320.18 162.7 280.63 171.05 307.72 201.05 303.44 241.24 340.34 224.75 377.24 241.24 372.96 201.05 400.05 171.05 360.5 162.7 340.34 127.67"></polygon><polygon points="440 325.68 414.09 320.21 400.88 297.25 387.68 320.21 361.77 325.68 379.51 345.33 376.71 371.66 400.88 360.86 425.06 371.66 422.25 345.33"></polygon><path d="m218 227.5c0-89.167 51.306-166.34 126-203.64-30.557-15.26-65.022-23.86-101.5-23.86-125.64 0-227.5 101.86-227.5 227.5s101.86 227.5 227.5 227.5c36.478 0 70.943-8.6 101.5-23.86-74.694-37.302-126-114.47-126-203.64z"></path></svg> <svg class="light-toggle" viewBox="0 0 612 612" xmlns="http://www.w3.org/2000/svg"><title>Light mode switch icon</title><path d="m306 149.34c-86.382 0-156.66 70.278-156.66 156.66 0 86.382 70.278 156.66 156.66 156.66s156.66-70.278 156.66-156.66c0-86.384-70.278-156.66-156.66-156.66z"></path><path d="m274.19 117.28h63.612c5.032 0 9.356-2.101 11.863-5.763 2.508-3.662 2.9-8.453 1.079-13.146l-34.999-90.112c-2.789-7.184-7.305-8.256-9.749-8.256s-6.96 1.073-9.749 8.255l-35 90.114c-1.821 4.692-1.427 9.482 1.079 13.145 2.507 3.663 6.832 5.763 11.864 5.763z"></path><path d="m337.81 494.72h-63.612c-5.032 0-9.357 2.102-11.863 5.764-2.506 3.663-2.9 8.453-1.079 13.145l34.999 90.114c2.789 7.182 7.305 8.254 9.749 8.254s6.96-1.072 9.749-8.254l34.999-90.115c1.821-4.69 1.429-9.48-1.079-13.144-2.507-3.662-6.831-5.764-11.863-5.764z"></path><path d="m127.54 190.82c2.412 5.477 7.028 8.746 12.348 8.746 3.644 0 7.257-1.608 10.174-4.526l44.981-44.98c3.558-3.558 5.13-8.102 4.312-12.466-0.819-4.362-3.928-8.028-8.532-10.056l-88.467-38.973c-2.233-0.983-4.336-1.482-6.25-1.482-3.201 0-5.959 1.415-7.568 3.882-1.357 2.081-2.454 5.747 0.031 11.389l38.971 88.466z"></path><path d="m484.46 421.18c-2.412-5.477-7.027-8.746-12.346-8.746-3.645 0-7.259 1.609-10.177 4.527l-44.981 44.98c-3.558 3.559-5.13 8.104-4.312 12.466s3.929 8.028 8.532 10.055l88.466 38.974c2.233 0.983 4.336 1.482 6.25 1.482 3.201 0 5.959-1.417 7.568-3.882 1.358-2.083 2.455-5.748-0.03-11.389l-38.97-88.467z"></path><path d="m461.94 195.04c2.918 2.918 6.532 4.526 10.176 4.526 5.319 0 9.934-3.269 12.348-8.746l38.972-88.465c2.486-5.643 1.389-9.308 0.031-11.389-1.609-2.467-4.367-3.882-7.568-3.882-1.914 0-4.017 0.499-6.251 1.483l-88.466 38.97c-4.604 2.029-7.715 5.694-8.532 10.057-0.818 4.363 0.754 8.908 4.312 12.466l44.978 44.98z"></path><path d="m150.06 416.96c-2.918-2.918-6.532-4.527-10.177-4.527-5.319 0-9.934 3.269-12.346 8.746l-38.972 88.465c-2.486 5.643-1.389 9.308-0.031 11.39 1.609 2.466 4.368 3.882 7.568 3.882 1.914 0 4.017-0.499 6.251-1.484l88.466-38.972c4.604-2.028 7.715-5.694 8.532-10.056 0.818-4.362-0.753-8.907-4.312-12.466l-44.979-44.978z"></path><path d="m603.74 296.25-90.111-34.996c-1.942-0.755-3.896-1.137-5.806-1.137-7.593 0-13.104 5.921-13.104 14.078l1e-3 63.613c0 8.157 5.511 14.078 13.104 14.078 1.912 0 3.866-0.382 5.806-1.136l90.112-34.999c7.182-2.79 8.254-7.306 8.254-9.751 0-2.443-1.075-6.961-8.256-9.75z"></path><path d="m104.17 351.89c7.594 0 13.106-5.921 13.106-14.078v-63.613c0-8.157-5.511-14.078-13.106-14.078-1.912 0-3.864 0.382-5.805 1.136l-90.113 34.998c-7.182 2.789-8.255 7.305-8.255 9.75 0 2.444 1.072 6.96 8.255 9.752l90.111 34.996c1.942 0.754 3.895 1.137 5.807 1.137z"></path></svg></div></header><div id="main" class="container"><div class="reading-progress-bar"></div><article class="single-article"><header><h1>在 2023 重新学习 Unicode (UTF-8)</h1></header><div class="top-meta"><time>Nov 19 2023</time></div><div class="notice"><p><a href="https://zh.wikipedia.org/zh-hans/Wikipedia:%E5%B0%8F%E4%BD%9C%E5%93%81">本文是一篇小作品，取自维基百科的体裁定义</a> &rarr;</p></div><p>中英对照版原文: <a href="https://blog.xinshijiededa.men/unicode/#user-content-fn-touche">The Absolute Minimum Every Software Developer Must Know About Unicode in 2023 (Still No Excuses!)</a> by Nikita</p><p>UTF-8 是可变长编码，指的是其中的每个字符（character）所占字节数为 1 至 4。字符被指定了对应的数字序号，也就是码位（code point），所以码位和字符是一一对应的。所谓编码（encoding），就是码位在内存中的存储方式。 UTF-16 最初被设计为一种定长的编码，也就是每个码位始终由 16 个字节表示，但随后我们发现这样做是不可行的。</p><p>码位的概念只和存储直接相关，而对于人的交互和使用来说，扩展字位簇（extended grapheme cluster）才是我们直观认为的最小单元。每个 grapheme 可以使用多个码位进行编码：</p><blockquote><p>比如说，<code>é</code>（一个单独的字位）在 Unicode 中被编码为 <code>e</code>（U+0065 拉丁小写字母 E）+ <code>´</code>（U+0301 连接重音符）。两个码位！</p></blockquote><p>grapheme 应当在使用中被视为不可分割的单元，应该作为整体被选择、复制、删除 —— 这意味着我们认为很直观的 <code>len</code>，<code>substring</code> 等方法，正确的处理都并不能靠 code point 作为区分标准，而需要查阅 Unicode 的表。 而且，Unicode 标准每年还在更新，这意味着我们需要一个外部库来处理 Unicode，比如 Rust 的 <a href="https://crates.io/crates/unicode-segmentation">unicode-segmentation</a> 。（很难指望编程语言跟上这个步伐，不过，据作者说 Swift 好像是现代语言中做的较好的）。</p><p>Unicode 还有其他的 intricacies 和 imperfections，其中之一就是有些字形被分配了相同的码位，而依赖区域设置 (locale) 。甚至有些意想不到的操作（<code>String::toLowerCase</code>）也与区域相关。而另一些字形互为变体，在进行搜索、比对等操作时，似乎应该归一化。</p></article><div class="author-info"><p>Originally published on <time>November 19 2023</time> by star-du</p></div><div class="bottom-meta"><div class="post-tags"><p>Tagged as:</p><ul><li><a title="Articles tagged as 'article-review'" href="/eleventy-blog/tag/article-review/">article-review</a></li><li><a title="Articles tagged as 'dev'" href="/eleventy-blog/tag/dev/">dev</a></li><li><a title="Articles tagged as 'stub'" href="/eleventy-blog/tag/stub/">stub</a></li></ul></div><div class="share-buttons"><p>Share this article:</p><div class="mastodon-share-dialog"><p id="which-instance-label"><b>To which instance?</b></p><p>Clicking Share will open a new browser tab. Make sure your browser permits websites to open new tabs.</p><p>You will be able to modify your status contents before submitting.</p><p>Example: <code>mastodon.social</code></p><form class="mastodon-share-form"><input class="instance-url-input" aria-labelledby="which-instance-label"> <input class="share-form-submit" type="submit" value="Share" disabled=""></form><p><span class="close-link" tabindex="0">Close this window</span></p></div><ul><li><div data-tooltip="Share on Mastodon - opens prompt window" class="mastodon" tabindex="0"><svg role="img" viewBox="0 0 61 65" xmlns="http://www.w3.org/2000/svg"><title>Mastodon icon</title><path class="fillable" d="m60.754 14.39c-0.9396-6.984-7.0266-12.488-14.242-13.554-1.2174-0.18021-5.8298-0.83607-16.514-0.83607h-0.0798c-10.688 0-12.98 0.65585-14.198 0.83607-7.0147 1.037-13.421 5.9825-14.975 13.049-0.74757 3.4802-0.82735 7.3385-0.68847 10.878 0.19797 5.0755 0.23638 10.142 0.69734 15.197 0.31867 3.3577 0.87458 6.6886 1.6636 9.9678 1.4774 6.0563 7.458 11.096 13.317 13.152 6.2733 2.1443 13.02 2.5003 19.484 1.0281 0.7111-0.1654 1.4134-0.3574 2.1068-0.5761 1.5719-0.4992 3.4128-1.0576 4.7661-2.0384 0.0186-0.0138 0.0338-0.0316 0.0445-0.052 0.0108-0.0205 0.0168-0.0431 0.0176-0.0662v-4.8982c-4e-4 -0.0216-0.0055-0.0428-0.0151-0.0622-0.0096-0.0193-0.0234-0.0363-0.0404-0.0496s-0.0368-0.0226-0.0579-0.0273c-0.021-0.0047-0.0429-0.0046-0.0639 2e-4 -4.1416 0.9892-8.3856 1.485-12.644 1.4772-7.3279 0-9.2988-3.4772-9.8631-4.9248-0.4537-1.2511-0.7418-2.5562-0.8569-3.882-0.0012-0.0222 0.0029-0.0445 0.0119-0.0649 9e-3 -0.0203 0.0227-0.0383 0.04-0.0524s0.0376-0.024 0.0594-0.0287c0.0218-0.0048 0.0444-0.0043 0.066 0.0013 4.0725 0.9824 8.2473 1.4782 12.437 1.4771 1.0075 0 2.0122 0 3.0198-0.0266 4.2135-0.1182 8.6546-0.3338 12.8-1.1433 0.1034-0.0207 0.2069-0.0384 0.2955-0.065 6.539-1.2556 12.762-5.1966 13.394-15.176 0.0236-0.3929 0.0827-4.1153 0.0827-4.523 0.0029-1.3856 0.4462-9.829-0.065-15.017z"></path><path class="fillable-2" d="m50.394 22.237v17.351h-6.8758v-16.84c0-3.5452-1.4774-5.3532-4.4825-5.3532-3.3035 0-4.9582 2.1389-4.9582 6.3636v9.2174h-6.8344v-9.2174c0-4.2247-1.6577-6.3636-4.9612-6.3636-2.9873 0-4.4795 1.808-4.4795 5.3532v16.84h-6.8729v-17.351c0-3.5452 0.9052-6.3616 2.7155-8.4493 1.8675-2.0828 4.317-3.1522 7.3575-3.1522 3.5192 0 6.1785 1.353 7.9514 4.0562l1.7108 2.8716 1.7138-2.8716c1.7729-2.7032 4.4322-4.0562 7.9455-4.0562 3.0376 0 5.4871 1.0694 7.3604 3.1522 1.8084 2.0857 2.7116 4.9022 2.7096 8.4493z"></path></svg></div></li><ul><li><a target="_blank" rel="noopener noreferrer" data-tooltip="Share on Twitter - opens a new tab" href="https://twitter.com/intent/tweet/?text=在 2023 重新学习 Unicode (UTF-8)&amp;url=https://star-du.github.io/eleventy-blog/2023-unicode-utf-8/" class="twitter"><svg role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><title>Twitter icon</title><path class="fillable" d="M23.953 4.57a10 10 0 01-2.825.775 4.958 4.958 0 002.163-2.723c-.951.555-2.005.959-3.127 1.184a4.92 4.92 0 00-8.384 4.482C7.69 8.095 4.067 6.13 1.64 3.162a4.822 4.822 0 00-.666 2.475c0 1.71.87 3.213 2.188 4.096a4.904 4.904 0 01-2.228-.616v.06a4.923 4.923 0 003.946 4.827 4.996 4.996 0 01-2.212.085 4.936 4.936 0 004.604 3.417 9.867 9.867 0 01-6.102 2.105c-.39 0-.779-.023-1.17-.067a13.995 13.995 0 007.557 2.209c9.053 0 13.998-7.496 13.998-13.985 0-.21 0-.42-.015-.63A9.935 9.935 0 0024 4.59z"></path></svg></a></li><ul><li><a target="_blank" rel="noopener noreferrer" data-tooltip="Share on Hacker News - opens a new tab" href="https://news.ycombinator.com/submitlink?u=https://star-du.github.io/eleventy-blog/2023-unicode-utf-8/&amp;t=在 2023 重新学习 Unicode (UTF-8)" class="hackernews"><svg role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><title>Hacker News icon</title><path class="fillable" d="M124 91h51l81 162 81-164h51L276 293v136h-40V293z"></path></svg></a></li><ul><li><div class="clipboard" rel="noopener noreferrer" data-tooltip="Copy article URL to clipboard" tabindex="0"><svg role="img" viewBox="0 0 115.77 122.88" xml:space="preserve" xmlns="http://www.w3.org/2000/svg"><title>Copy to clipboard icon</title><path class="fillable" d="m89.62 13.96v7.73h12.2v0.02c3.85 0.01 7.34 1.57 9.86 4.1 2.5 2.51 4.06 5.98 4.07 9.82h0.02v73.3h-0.02c-0.01 3.84-1.57 7.33-4.1 9.86-2.51 2.5-5.98 4.06-9.82 4.07v0.02h-61.73v-0.02c-3.84-0.01-7.34-1.57-9.86-4.1-2.5-2.51-4.06-5.98-4.07-9.82h-0.02v-16.43h-12.2v-0.02c-3.84-0.01-7.34-1.57-9.86-4.1-2.5-2.51-4.06-5.98-4.07-9.82h-0.02v-64.62h0.02c0.01-3.85 1.58-7.34 4.1-9.86 2.51-2.5 5.98-4.06 9.82-4.07v-0.02h61.73v0.02c3.85 0.01 7.34 1.57 9.86 4.1 2.5 2.51 4.06 5.98 4.07 9.82h0.02v0.02zm-10.58 7.73v-7.75h0.02c0-0.91-0.39-1.75-1.01-2.37-0.61-0.61-1.46-1-2.37-1v0.02h-61.73v-0.02c-0.91 0-1.75 0.39-2.37 1.01-0.61 0.61-1 1.46-1 2.37h0.02v64.62h-0.02c0 0.91 0.39 1.75 1.01 2.37 0.61 0.61 1.46 1 2.37 1v-0.02h12.2v-46.28h0.02c0.01-3.85 1.58-7.34 4.1-9.86 2.51-2.5 5.98-4.06 9.82-4.07v-0.02h38.94zm26.14 87.23v-73.29h0.02c0-0.91-0.39-1.75-1.01-2.37-0.61-0.61-1.46-1-2.37-1v0.02h-61.73v-0.02c-0.91 0-1.75 0.39-2.37 1.01-0.61 0.61-1 1.46-1 2.37h0.02v73.3h-0.02c0 0.91 0.39 1.75 1.01 2.37 0.61 0.61 1.46 1 2.37 1v-0.02h61.73v0.02c0.91 0 1.75-0.39 2.37-1.01 0.61-0.61 1-1.46 1-2.37h-0.02v-0.01z"></path></svg></div></li></ul></ul></ul></ul></div></div><div class="post-navigation"><ul><li><a href="/eleventy-blog/why-writing-blog/"><span class="headline">← Newer article</span> <span class="title">写博客之意义三则</span></a></li><li><a href="/eleventy-blog/extraterrestrial-life/"><span class="headline">Older article →</span> <span class="title">《地外生命》——我们是孤独的吗？</span></a></li></ul></div><div class="scroll-up-arrow" tabindex="0"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1000 1000"><g><path class="fillable" d="M990,699.9c0,8.1,0,16.3-8.1,24.4c-16.3,16.3-40.7,16.3-56.9,0L502,350.2L79.1,732.4c-16.3,16.3-40.7,16.3-56.9,0c-16.3-16.3-16.3-40.7,0-56.9l447.3-406.6c24.4-16.3,40.7-16.3,56.9-8.1l447.3,406.6C981.9,675.5,990,691.8,990,699.9z"></path></g></svg></div><footer class="footer"><div class="container"><div class="links"><ul><li><a href="/eleventy-blog/about/"><span>About</span></a></li><li><a href="/eleventy-blog/all-articles/"><span>All Articles</span></a></li><li><a href="/eleventy-blog/subscribe/"><span>Subscribe</span></a></li><li><a href="/eleventy-blog/inspirations/"><span>Inspirations</span></a></li></ul><ul></ul></div><div class="copyright">&copy; 2018-2024 <a href="https://github.com/star-du">star-du</a><br>Powered by <a href="https://11ty.dev">Eleventy</a><br>Template: <a href="https://github.com/lwojcik/eleventy-template-bliss">Bliss</a> by <a href="https://offbeatbits.com">Offbeat Bits</a></div></div></footer></div></body></html>